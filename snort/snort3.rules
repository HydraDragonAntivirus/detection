################################################
# Author: ditekSHen
# Reference: https://github.com/ditekshen/detection
# ##############################################
#
################################################
# INDICATOR DOCUMENTS
################################################
alert file ( msg:"INDICATOR-DOCUMENT Ancalog RTF exploit builder document detected"; file_type:"RTF"; file_data; content:"|5C|*|5C|ancalog",fast_pattern,nocase; service:http, smtp; rem:"yara:INDICATOR_RTF_Ancalog_Exploit_Builder_Document, clamav:INDICATOR.RTF.AncalogExploitBuilderDocument, tlp:white "; classtype:trojan-activity; sid:910000; rev:1; )
alert file ( msg:"INDICATOR-DOCUMENT Exploit RTF document Equation-BITSAdmin downloader detected"; file_type:"RTF"; file_data; content:"0200000002ce020000000000c000000000000046",fast_pattern,nocase; content:"6269747361646d696e",nocase; service:http, smtp; rem:"yara:INDICATOR_RTF_Equation_BITSAdmin_Downloader, clamav:INDICATOR.RTF.EquationBITSAdminDownloader, tlp:white "; classtype:trojan-activity; sid:910001; rev:1; )
alert file ( msg:"INDICATOR-DOCUMENT Exploit RTF document Equation-PowerShell downloader detected"; file_type:"RTF"; file_data; content:"0200000002ce020000000000c000000000000046",fast_pattern,nocase; content:"706f7765727368656c6c",nocase; service:http, smtp; rem:"yara:INDICATOR_RTF_Equation_PowerShell_Downloader, clamav:INDICATOR.RTF.EquationPowerShellDownloader, tlp:white "; classtype:trojan-activity; sid:910002; rev:1; )
alert file ( msg:"INDICATOR-DOCUMENT Exploit RTF document Equation-CertUtil downloader detected"; file_type:"RTF"; file_data; content:"0200000002ce020000000000c000000000000046",fast_pattern,nocase; content:"636572747574696c",nocase; service:http, smtp; rem:"yara:INDICATOR_RTF_Equation_CertUtil_Downloader, clamav:INDICATOR.RTF.EquationCertUtilDownloader, tlp:white "; classtype:trojan-activity; sid:910003; rev:1; )
################################################
# MALWARE
################################################
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.RevengeRAT information outbound connection"; flow:to_server,established; content:"InformationRevenge-RAT",fast_pattern; rem:"yara:MALWARE_Win_RevengeRAT, clamav:MALWARE.Win.RevengeRAT"; classtype:trojan-activity; sid:920000; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.RevengeRAT keep alive outbound connection"; flow:to_server,established; content:"keepAlivePing!!@#%",fast_pattern; rem:"yara:MALWARE_Win_RevengeRAT, clamav:MALWARE.Win.RevengeRAT"; classtype:trojan-activity; sid:920001; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.RevengeRAT PNC outbound connection"; flow:to_server,established; content:"PNC!@#%",fast_pattern; rem:"yara:MALWARE_Win_RevengeRAT, clamav:MALWARE.Win.RevengeRAT"; classtype:trojan-activity; sid:920002; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.XpertRAT outbound connection"; flow:to_server,established; content:"400|7C|root|7C|",fast_pattern; rem:"yara:MALWARE_Win_XpertRAT, clamav:MALWARE.Win.XpertRAT"; classtype:trojan-activity; sid:920003; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.XpertRAT outbound connection"; flow:to_server,established; dsize:10; content:"|7C|root|7C|",offset 3,depth 6,fast_pattern; isdataat:!1,relative; rem:"yara:MALWARE_Win_XpertRAT, clamav:MALWARE.Win.XpertRAT"; classtype:trojan-activity; sid:920004; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.XpertRAT outbound connection"; flow:to_server,established; content:"|7C|root|7C|",within 9,fast_pattern; pcre:"/\d{1,3}\x7croot\x7c\d/"; rem:"yara:MALWARE_Win_XpertRAT, clamav:MALWARE.Win.XpertRAT"; classtype:trojan-activity; sid:920005; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Trojan.XpertRAT inbound connection"; flow:to_client,established; dsize:<12; content:"400|7C|0|7C|"; content:"@#@!",distance 1; rem:"yara:MALWARE_Win_XpertRAT, clamav:MALWARE.Win.XpertRAT"; classtype:trojan-activity; sid:920006; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.Agent downloader outbound connection"; flow:to_server,established; http_header:field user-agent; content:"Mozilla/5.0 Gecko/41.0 Firefox/41.0",fast_pattern; http_uri; content:"/?v="; content:"&g="; rem:"yara:MALWARE_Win_DA1, clamav:MALWARE.Win.DA1"; classtype:trojan-activity; sid:920007; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Ransomware.VSSDestroy/Matrix variant post-infection outbound connection"; flow:to_server,established; http_uri; content:"/addrecord.php",fast_pattern; content:"apikey="; content:"&compuser="; content:"&sid="; content:"&phase="; rem:"yara:MALWARE_Win_VSSDestroy, clamav:MALWARE.Win.VSSDestroy"; classtype:trojan-activity; sid:920008; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Ransomware.VSSDestroy/Matrix variant post-infection outbound connection"; flow:to_server,established; http_uri; content:"/addrec.php",fast_pattern; content:"apikey="; content:"&compuser="; content:"&sid="; content:"&phase="; rem:"yara:MALWARE_Win_VSSDestroy, clamav:MALWARE.Win.VSSDestroy"; classtype:trojan-activity; sid:920009; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.WSHRAT variant outbound connection"; flow:to_server,established; http_header:field user-agent; content:"WSHRAT",fast_pattern; rem:"yara:MALWARE_Win_WSHRAT, clamav:MALWARE.Win.WSHRAT"; classtype:trojan-activity; sid:920010; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.WSHRAT variant outbound connection"; flow:to_server,established; http_header; content:"user-agent:: <|7C|>",fast_pattern; rem:"yara:MALWARE_Win_WSHRAT, clamav:MALWARE.Win.WSHRAT"; classtype:trojan-activity; sid:920011; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.WSHRAT variant second stage outbound connection"; http_method; content: "GET"; content:"/open-keylogger HTTP/1.",within 23; rem:"yara:MALWARE_Win_WSHRAT, clamav:MALWARE.Win.WSHRAT"; classtype:trojan-activity; sid:920012; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"INDICATOR-COMPROMISE Koadic framework C&C outbound connection"; flow:to_server,established; http_header; content:"encoder:"; content:"shellchcp:"; rem:"yara:MALWARE_DOC_KoadicDOC, yara:MALWARE_BAT_KoadicBAT, yara:MALWARE_JS_KoadicJS, clamav:MALWARE.DOC.KoadicDOC, clamav:MALWARE.BAT.KoadicBAT, clamav:MALWARE.JS.KoadicJS"; reference:url,attack.mitre.org/software/S0250; classtype:trojan-activity; sid:920013; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"INDICATOR-COMPROMISE Koadic framework C&C outbound connection"; flow:to_server,established; http_header; content:"errdesc:"; content:"errno:"; content:"errname:"; rem:"yara:MALWARE_DOC_KoadicDOC, yara:MALWARE_BAT_KoadicBAT, yara:MALWARE_JS_KoadicJS, clamav:MALWARE.DOC.KoadicDOC, clamav:MALWARE.BAT.KoadicBAT, clamav:MALWARE.JS.KoadicJS"; reference:url,attack.mitre.org/software/S0250; classtype:trojan-activity; sid:920014; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"INDICATOR-COMPROMISE Koadic framework C&C download payload outbound connection"; flow:to_server,established; http_header; content:"X-UploadFileJob:",fast_pattern; content:"Referer:"; pcre:"/X-UploadFileJob:\s(true|false)\x0d\x0a/"; rem:"yara:MALWARE_DOC_KoadicDOC, yara:MALWARE_BAT_KoadicBAT, yara:MALWARE_JS_KoadicJS, clamav:MALWARE.DOC.KoadicDOC, clamav:MALWARE.BAT.KoadicBAT, clamav:MALWARE.JS.KoadicJS"; reference:url,attack.mitre.org/software/S0250; classtype:trojan-activity; sid:920015; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"INDICATOR-COMPROMISE Koadic framework C&C outbound connection"; flow:to_server,established; http_uri; content:"./mshtml,RunHTMLApplication",fast_pattern; content:"/html?"; rem:"yara:MALWARE_DOC_KoadicDOC, yara:MALWARE_BAT_KoadicBAT, yara:MALWARE_JS_KoadicJS, clamav:MALWARE.DOC.KoadicDOC, clamav:MALWARE.BAT.KoadicBAT, clamav:MALWARE.JS.KoadicJS"; reference:url,attack.mitre.org/software/S0250; classtype:trojan-activity; sid:920016; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"INDICATOR-COMPROMISE Koadic framework C&C outbound connection"; flow:to_server,established; http_uri; content:"=stage|3B|"; content:"/html?"; http_header; content:"Referer:"; rem:"yara:MALWARE_DOC_KoadicDOC, yara:MALWARE_BAT_KoadicBAT, yara:MALWARE_JS_KoadicJS, clamav:MALWARE.DOC.KoadicDOC, clamav:MALWARE.BAT.KoadicBAT, clamav:MALWARE.JS.KoadicJS"; reference:url,attack.mitre.org/software/S0250; classtype:trojan-activity; sid:920017; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"INDICATOR-COMPROMISE Koadic framework Windows host information exfiltration"; flow:to_server,established; http_client_body; content:"~~~Windows"; content:"~~~AMD",distance 0; content:"~~~C:|5C|Users",distance 0; rem:"yara:MALWARE_DOC_KoadicDOC, yara:MALWARE_BAT_KoadicBAT, yara:MALWARE_JS_KoadicJS, clamav:MALWARE.DOC.KoadicDOC, clamav:MALWARE.BAT.KoadicBAT, clamav:MALWARE.JS.KoadicJS"; reference:url,attack.mitre.org/software/S0250; classtype:trojan-activity; sid:920018; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.M00nD3v keylogger outbound HTTP connection"; flow:to_server,established; http_client_body; content:"token="; content:"&name="; content:"&type="; content:"&data="; http_header; content:!"User-Agent"; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_M00nD3v, clamav:MALWARE.Win.M00nD3v"; classtype:trojan-activity; sid:920019; rev:1; )
alert tcp $HOME_NET any -> $SMTP_SERVERS [25,26,587] ( msg:"MALWARE-CNC Win.Trojan.M00nD3v keylogger outbound SMTP connection - Execution"; flow:to_server,established; content:"Subject: Execution Alert!",fast_pattern; metadata:ruleset community, service smtp; rem:"yara:MALWARE_Win_M00nD3v, clamav:MALWARE.Win.M00nD3v"; classtype:trojan-activity; sid:920020; rev:1; )
alert tcp $HOME_NET any -> $SMTP_SERVERS [25,26,587] ( msg:"MALWARE-CNC Win.Trojan.M00nD3v keylogger outbound SMTP connection - Password"; flow:to_server,established; content:"Subject: Password Monitoring",fast_pattern; metadata:ruleset community, service smtp; rem:"yara:MALWARE_Win_M00nD3v, clamav:MALWARE.Win.M00nD3v"; classtype:trojan-activity; sid:920021; rev:1; )
alert tcp $HOME_NET any -> $SMTP_SERVERS [25,26,587] ( msg:"MALWARE-CNC Win.Trojan.M00nD3v keylogger outbound SMTP connection - Keystroke"; flow:to_server,established; content:"Subject: KeyStroke Monitoring",fast_pattern; metadata:ruleset community, service smtp; rem:"yara:MALWARE_Win_M00nD3v, clamav:MALWARE.Win.M00nD3v"; classtype:trojan-activity; sid:920022; rev:1; )
alert tcp $HOME_NET any -> $SMTP_SERVERS [25,26,587] ( msg:"MALWARE-CNC Win.Trojan.M00nD3v keylogger outbound SMTP connection - Screen"; flow:to_server,established; content:"Subject: Screen Monitoring",fast_pattern; metadata:ruleset community, service smtp; rem:"yara:MALWARE_Win_M00nD3v, clamav:MALWARE.Win.M00nD3v"; classtype:trojan-activity; sid:920023; rev:1; )
alert tcp $HOME_NET any -> $SMTP_SERVERS [25,26,587] ( msg:"MALWARE-CNC Win.Trojan.M00nD3v keylogger outbound SMTP connection - Webcam"; flow:to_server,established; content:"Subject: WebCam Monitoring",fast_pattern; metadata:ruleset community, service smtp; rem:"yara:MALWARE_Win_M00nD3v, clamav:MALWARE.Win.M00nD3v"; classtype:trojan-activity; sid:920024; rev:1; )
alert tcp $HOME_NET any -> $SMTP_SERVERS [25,26,587] ( msg:"MALWARE-CNC Win.Trojan.M00nD3v keylogger outbound SMTP connection - Clipboard"; flow:to_server,established; content:"Subject: Clipboard Monitoring",fast_pattern; metadata:ruleset community, service smtp; rem:"yara:MALWARE_Win_M00nD3v, clamav:MALWARE.Win.M00nD3v"; classtype:trojan-activity; sid:920025; rev:1; )
alert tcp $HOME_NET any -> $SMTP_SERVERS [25,26,587] ( msg:"MALWARE-CNC Win.Trojan.M00nD3v keylogger outbound SMTP connection"; flow:to_server,established; content:"U3RlYWxlciBMb2dz",fast_pattern; content:"Subject: =?utf-8"; metadata:ruleset community, service smtp; rem:"yara:MALWARE_Win_M00nD3v, clamav:MALWARE.Win.M00nD3v"; classtype:trojan-activity; sid:920026; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] ( msg:"MALWARE-CNC Win.Trojan.Phoenix/404keylogger variant outbound SMTP connection"; flow:to_server,established; content:"Subject: "; content:"PSWD |7C| Client Name:",fast_pattern,within 50; metadata:ruleset community, service smtp; rem:"yara:MALWARE_Win_Phoenix, clamav:MALWARE.Win.Phoenix"; classtype:trojan-activity; sid:920027; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] ( msg:"MALWARE-CNC Win.Trojan.Phoenix/404keylogger variant outbound SMTP connection"; flow:to_server,established; content:"Keylogger - Passwords -------|7C|",fast_pattern; metadata:ruleset community, service smtp; rem:"yara:MALWARE_Win_Phoenix, clamav:MALWARE.Win.Phoenix"; classtype:trojan-activity; sid:920028; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] ( msg:"MALWARE-CNC Win.Trojan.Phoenix/404keylogger variant outbound SMTP connection"; flow:to_server,established; content:"|3B| name=|22|PXRecoveries |7C|",fast_pattern; content:".txt",within 30; metadata:ruleset community, service smtp; rem:"yara:MALWARE_Win_Phoenix, clamav:MALWARE.Win.Phoenix"; classtype:trojan-activity; sid:920029; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] ( msg:"MALWARE-CNC Win.Trojan.Phoenix/404keylogger variant outbound SMTP connection"; flow:to_server,established; content:"IP:"; content:"Owner Name:"; content:"OS Name:"; content:"Platform:"; metadata:ruleset community, service smtp; rem:"yara:MALWARE_Win_Phoenix, clamav:MALWARE.Win.Phoenix"; classtype:trojan-activity; sid:920030; rev:1; )
alert tcp $HOME_NET any -> $SMTP_SERVERS [25,26,587] ( msg:"MALWARE-CNC Win.Trojan.Phoenix/404keylogger outbound SMTP connection"; flow:to_server,established; content:"Subject: PSWD|7C|",fast_pattern; metadata:ruleset community, service smtp; rem:"yara:MALWARE_Win_Phoenix, clamav:MALWARE.Win.Phoenix"; classtype:trojan-activity; sid:920031; rev:1; )
alert tcp $HOME_NET any -> $SMTP_SERVERS [25,26,587] ( msg:"MALWARE-CNC Win.Trojan.Phoenix/404keylogger outbound SMTP connection"; flow:to_server,established; content:"Subject: Logs|7C|",fast_pattern; metadata:ruleset community, service smtp; rem:"yara:MALWARE_Win_Phoenix, clamav:MALWARE.Win.Phoenix"; classtype:trojan-activity; sid:920032; rev:1; )
alert tcp $HOME_NET any -> $SMTP_SERVERS [25,26,587] ( msg:"MALWARE-CNC Win.Trojan.Phoenix/404keylogger outbound SMTP connection"; flow:to_server,established; content:"Subject: Screenshot|7C|",fast_pattern; metadata:ruleset community, service smtp; rem:"yara:MALWARE_Win_Phoenix, clamav:MALWARE.Win.Phoenix"; classtype:trojan-activity; sid:920033; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] ( msg:"MALWARE-CNC Win.Trojan.HawkEye outbound SMTP connection"; flow:to_server,established; content:"- Passwords Logs -",fast_pattern; metadata:ruleset community, service smtp; rem:"yara:MALWARE_Win_HawkEyev9, clamav:MALWARE.Win.HawkEyev9"; classtype:trojan-activity; sid:920034; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] ( msg:"MALWARE-CNC Win.Trojan.HawkEye outbound SMTP connection"; flow:to_server,established; content:"- Keyboard Logs -",fast_pattern; metadata:ruleset community, service smtp; rem:"yara:MALWARE_Win_HawkEyev9, clamav:MALWARE.Win.HawkEyev9"; classtype:trojan-activity; sid:920035; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] ( msg:"MALWARE-CNC Win.Trojan.HawkEye outbound SMTP connection"; flow:to_server,established; content:"Subject: Logger - Server Ran",fast_pattern; metadata:ruleset community, service smtp; rem:"yara:MALWARE_Win_HawkEyev9, clamav:MALWARE.Win.HawkEyev9"; classtype:trojan-activity; sid:920036; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] ( msg:"MALWARE-CNC Win.Trojan.HawkEye outbound SMTP connection"; flow:to_server,established; content:"Subject: Logger|7C|",fast_pattern; metadata:ruleset community, service smtp; rem:"yara:MALWARE_Win_HawkEyev9, clamav:MALWARE.Win.HawkEyev9"; classtype:trojan-activity; sid:920037; rev:1; )
alert tcp $HOME_NET any -> $SMTP_SERVERS [25,26,587] ( msg:"MALWARE-CNC Win.Trojan.HawkEye outbound SMTP connection"; flow:to_server,established; content:"SGF3a0V5ZSBSZ",fast_pattern; content:"Subject: =?utf-8"; metadata:ruleset community, service smtp; rem:"yara:MALWARE_Win_HawkEyev9, clamav:MALWARE.Win.HawkEyev9"; classtype:trojan-activity; sid:920038; rev:1; )
alert tcp $HOME_NET any -> $SMTP_SERVERS [25,26,587] ( msg:"MALWARE-CNC Win.Trojan.HawkEye outbound SMTP connection"; flow:to_server,established; content:"SGF3a0V5ZSBLZXlsb",fast_pattern; content:"Subject: =?utf-8"; metadata:ruleset community, service smtp; rem:"yara:MALWARE_Win_HawkEyev9, clamav:MALWARE.Win.HawkEyev9"; classtype:trojan-activity; sid:920039; rev:1; )
alert tcp $HOME_NET any -> $SMTP_SERVERS [25,26,587] ( msg:"MALWARE-CNC Win.Trojan.HawkEye outbound SMTP connection"; flow:to_server,established; content:"Subject: HawkEye Keylogger",fast_pattern; metadata:ruleset community, service smtp; rem:"yara:MALWARE_Win_HawkEyev9, clamav:MALWARE.Win.HawkEyev9"; classtype:trojan-activity; sid:920040; rev:1; )
alert tcp $HOME_NET any -> $SMTP_SERVERS [25,26,587] ( msg:"MALWARE-CNC Win.Trojan.HawkEye outbound SMTP connection"; flow:to_server,established; content:"Subject: HawkEye Reborn",fast_pattern; metadata:ruleset community, service smtp; rem:"yara:MALWARE_Win_HawkEyev9, clamav:MALWARE.Win.HawkEyev9"; classtype:trojan-activity; sid:920041; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 21 ( msg:"MALWARE-CNC Win.Trojan.HawkEye outbound FTP connection"; flow:to_server,established; content:"STOR HawkEyeReborn",fast_pattern,depth 18; metadata:ruleset community, service ftp; rem:"yara:MALWARE_Win_HawkEyev9, clamav:MALWARE.Win.HawkEyev9"; classtype:trojan-activity; sid:920042; rev:1; )
alert tcp $HOME_NET any -> $SMTP_SERVERS 21 ( msg:"MALWARE-CNC Win.Trojan.HawkEye outbound FTP connection"; flow:to_server,established; content:"STORHawkEye",fast_pattern,depth 11; metadata:ruleset community, service ftp; rem:"yara:MALWARE_Win_HawkEyev9, clamav:MALWARE.Win.HawkEyev9"; classtype:trojan-activity; sid:920043; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 21 ( msg:"MALWARE-CNC Win.Trojan.HawkEye outbound FTP connection"; flow:to_server,established; content:"STOR HawkEyeKeylogger",fast_pattern,depth 21; metadata:ruleset community, service ftp; rem:"yara:MALWARE_Win_HawkEyev9, clamav:MALWARE.Win.HawkEyev9"; classtype:trojan-activity; sid:920044; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.HawkEye outbound HTTP connection"; flow:to_server,established; http_client_body; content:"Secret="; content:"HWID=",nocase; content:"Name=",nocase; content:"OS=",nocase; content:"Type=",nocase; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_HawkEyev9, clamav:MALWARE.Win.HawkEyev9"; classtype:trojan-activity; sid:920045; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] ( msg:"MALWARE-CNC Win.Trojan.AspireLogger outbound SMTP connection"; flow:to_server,established; content:"Subject: AspireLogger [",fast_pattern; metadata:ruleset community, service smtp; rem:"yara:MALWARE_Win_Aspire, clamav:MALWARE.Win.Aspire"; classtype:trojan-activity; sid:920046; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] ( msg:"MALWARE-CNC Win.Trojan.AspireLogger outbound SMTP connection"; flow:to_server,established; content:"PC:"; content:"IP:",within 88; content:"Aspire"; metadata:ruleset community, service smtp; rem:"yara:MALWARE_Win_Aspire, clamav:MALWARE.Win.Aspire"; classtype:trojan-activity; sid:920047; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] ( msg:"MALWARE-CNC Win.Trojan.Orion keylogger outbound SMTP connection"; flow:to_server,established; content:"Subject: Orion Logger",fast_pattern; metadata:ruleset community, service smtp; rem:"yara:MALWARE_Win_Orion, clamav:MALWARE.Win.Orion"; classtype:trojan-activity; sid:920048; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] ( msg:"MALWARE-CNC Win.Trojan.Orion keylogger outbound SMTP connection"; flow:to_server,established; content:"System Details |7C|=3D="; content:"=0D=0AComputer Name:"; content:"=0D=0ACountry Name:"; metadata:ruleset community, service smtp; rem:"yara:MALWARE_Win_Orion, clamav:MALWARE.Win.Orion"; classtype:trojan-activity; sid:920049; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] ( msg:"MALWARE-CNC Win.Trojan.Firebird/Hive RAT outbound SMTP connection"; flow:to_server,established; content:"Subject: "; content:": PASSWORDS",within 150; metadata:ruleset community, service smtp; rem:"yara MALWARE_Win_FirebirdRAT, clamav MALWARE.Win.FirebirdRAT"; classtype:trojan-activity; sid:920050; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] ( msg:"MALWARE-CNC Win.Trojan.AgentTesla outbound SMTP connection"; flow:to_server,established; content:"Subject: "; content:"Passwords Recovered From:",fast_pattern,within 150; metadata:ruleset community, service smtp; rem:"yara:MALWARE_Win_AgentTeslaV2, yara:MALWARE_Win_AgentTeslaV3, clamav:MALWARE.Win.AgentTeslaV2, clamav:MALWARE.Win.AgentTeslaV3"; classtype:trojan-activity; sid:920051; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] ( msg:"MALWARE-CNC Win.Trojan.AgentTesla outbound SMTP connection"; flow:to_server,established; content:"Subject: "; content:"Screen Capture From: ",fast_pattern,within 150; metadata:ruleset community, service smtp; rem:"yara:MALWARE_Win_AgentTeslaV2, yara:MALWARE_Win_AgentTeslaV3, clamav:MALWARE.Win.AgentTeslaV2, clamav:MALWARE.Win.AgentTeslaV3"; classtype:trojan-activity; sid:920052; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] ( msg:"MALWARE-CNC Win.Trojan.AgentTesla outbound SMTP connection"; flow:to_server,established; content:"Subject: "; content:" Recovered Accounts",fast_pattern,within 150; metadata:ruleset community, service smtp; rem:"yara:MALWARE_Win_AgentTeslaV2, yara:MALWARE_Win_AgentTeslaV3, clamav:MALWARE.Win.AgentTeslaV2, clamav:MALWARE.Win.AgentTeslaV3"; classtype:trojan-activity; sid:920053; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] ( msg:"MALWARE-CNC Win.Trojan.AgentTesla outbound SMTP connection"; flow:to_server,established; content:"Subject: PW_",fast_pattern; metadata:ruleset community, service smtp; rem:"yara:MALWARE_Win_AgentTeslaV2, yara:MALWARE_Win_AgentTeslaV3, clamav:MALWARE.Win.AgentTeslaV2, clamav:MALWARE.Win.AgentTeslaV3"; classtype:trojan-activity; sid:920054; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] ( msg:"MALWARE-CNC Win.Trojan.AgentTesla outbound SMTP connection"; flow:to_server,established; content:"Subject: CO_",fast_pattern; metadata:ruleset community, service smtp; rem:"yara:MALWARE_Win_AgentTeslaV2, yara:MALWARE_Win_AgentTeslaV3, clamav:MALWARE.Win.AgentTeslaV2, clamav:MALWARE.Win.AgentTeslaV3"; classtype:trojan-activity; sid:920055; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] ( msg:"MALWARE-CNC Win.Trojan.AgentTesla outbound SMTP connection"; flow:to_server,established; content:"Subject: SC_",fast_pattern; metadata:ruleset community, service smtp; rem:"yara:MALWARE_Win_AgentTeslaV2, yara:MALWARE_Win_AgentTeslaV3, clamav:MALWARE.Win.AgentTeslaV2, clamav:MALWARE.Win.AgentTeslaV3"; classtype:trojan-activity; sid:920056; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] ( msg:"MALWARE-CNC Win.Trojan.AgentTesla outbound SMTP connection"; flow:to_server,established; content:"Subject: KL_",fast_pattern; metadata:ruleset community, service smtp; rem:"yara:MALWARE_Win_AgentTeslaV2, yara:MALWARE_Win_AgentTeslaV3, clamav:MALWARE.Win.AgentTeslaV2, clamav:MALWARE.Win.AgentTeslaV3"; classtype:trojan-activity; sid:920057; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 21 ( msg:"MALWARE-CNC Win.Trojan.AgentTesla outbound FTP connection"; flow:to_server,established; content:"STOR PW_",fast_pattern,depth 8; metadata:ruleset community, service ftp; rem:"yara:MALWARE_Win_AgentTeslaV2, yara:MALWARE_Win_AgentTeslaV3, clamav:MALWARE.Win.AgentTeslaV2, clamav:MALWARE.Win.AgentTeslaV3"; classtype:trojan-activity; sid:920058; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 21 ( msg:"MALWARE-CNC Win.Trojan.AgentTesla outbound FTP connection"; flow:to_server,established; content:"STOR CO_",fast_pattern,depth 8; metadata:ruleset community, service ftp; rem:"yara:MALWARE_Win_AgentTeslaV2, yara:MALWARE_Win_AgentTeslaV3, clamav:MALWARE.Win.AgentTeslaV2, clamav:MALWARE.Win.AgentTeslaV3"; classtype:trojan-activity; sid:920059; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 21 ( msg:"MALWARE-CNC Win.Trojan.AgentTesla outbound FTP connection"; flow:to_server,established; content:"STOR SC_",fast_pattern,depth 8; metadata:ruleset community, service ftp; rem:"yara:MALWARE_Win_AgentTeslaV2, yara:MALWARE_Win_AgentTeslaV3, clamav:MALWARE.Win.AgentTeslaV2, clamav:MALWARE.Win.AgentTeslaV3"; classtype:trojan-activity; sid:920060; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET 21 ( msg:"MALWARE-CNC Win.Trojan.AgentTesla outbound FTP connection"; flow:to_server,established; content:"STOR KL_",fast_pattern,depth 8; metadata:ruleset community, service ftp; rem:"yara:MALWARE_Win_AgentTeslaV2, yara:MALWARE_Win_AgentTeslaV3, clamav:MALWARE.Win.AgentTeslaV2, clamav:MALWARE.Win.AgentTeslaV3"; classtype:trojan-activity; sid:920061; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] ( msg:"MALWARE-CNC Win.Trojan.MassLogger outbound SMTP connection"; flow:to_server,established; content:"Subject: MassLogger |7C|",fast_pattern; metadata:ruleset community, service smtp; rem:"yara:MALWARE_Win_MassLogger, clamav:MALWARE.Win.MassLogger"; classtype:trojan-activity; sid:920062; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] ( msg:"MALWARE-CNC Win.Trojan.Generic keylogger outbound SMTP connection"; flow:to_server,established; content:"Subject: "; content: "Screen Capture",within 150; metadata:ruleset community, service smtp; classtype:trojan-activity; sid:920063; rev:1; )
#alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] ( msg:"MALWARE-CNC Win.Trojan.Generic keylogger outbound SMTP connection"; flow:to_server,established; content:"Subject: "; content: "Keylog",within 150; metadata:ruleset community, service smtp; classtype:trojan-activity; sid:920064; rev:1; )
alert http ( msg:"INDICATOR-DOCUMENT Doc.Trojan.ReconDoc outbound connection"; flow:to_server,established; http_uri; content:".php?id="; base64_decode:relative; base64_data; content:"document_name:"; content:"|7C|computer_name:"; content:"|7C|user_name:"; metadata:ruleset community, service http; classtype:trojan-activity; sid:920065; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Trojan.QuasarRAT inbound SSL certificate"; flow:to_client,established; content:"|55 04 03 0C|"; content:"Quasar Server CA",fast_pattern,distance 1; metadata:ruleset community, service ssl, yara MALWARE_Win_QuasarRAT; classtype:trojan-activity; sid:920066; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Trojan.AsyncRAT inbound SSL certificate"; flow:to_client,established; content:"|55 04 03 0C|"; content:"AsyncRAT Server",fast_pattern,distance 1; metadata:ruleset community, service ssl; classtype:trojan-activity; sid:920067; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Trojan.OrcusRAT inbound SSL certificate"; flow:to_client,established; content:"|55 04 03|"; content:"Orcus Server|30|",fast_pattern,distance 2; metadata:ruleset community, service ssl; classtype:trojan-activity; sid:920068; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Trojan.BitRAT inbound SSL certificate"; flow:to_client,established; content:"|55 04 03 0C|"; content:"BitRAT|30|",fast_pattern,distance 1; metadata:ruleset community, service ssl; classtype:trojan-activity; sid:920069; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Trojan.RevCode RAT inbound SSL certificate"; flow:to_client,established; content:"|55 04 03 0C|"; content:"*.revcode.se|30|",fast_pattern,distance 1; metadata:ruleset community, service ssl; rem:"yara:MALWARE_Win_RevCodeRAT, clamav:MALWARE.Win.Trojan.RevCodeRAT"; classtype:trojan-activity; sid:920070; rev:2; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Known malicious inbound SSL certificate"; flow:to_client,established; content:"|55 04 03 0C|";  content:" Server|30|",fast_pattern,distance 1; metadata:ruleset community, service ssl; classtype:trojan-activity; sid:920071; rev:2; )
alert http $HOME_NET any -> $EXTERNAL_NET any ( msg: "MALWARE-CNC Win.Trojan.RedLine initial outbound connection detected"; flow:to_server,established; http_uri; content:"/IRemotePanel",fast_pattern; bufferlen:13; http_header; content:"SOAPAction:"; http_method; content:"POST"; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_RedLine, clamav:MALWARE.Win.Trojan.RedLine-1,MALWARE.Win.Trojan.RedLine-2"; classtype:trojan-activity; sid:920072; rev:2; )
alert http $HOME_NET any -> $EXTERNAL_NET any ( msg: "MALWARE-CNC Win.Trojan.RedLine GetSettings outbound connection detected"; flow:to_server,established; http_header; content:"/IRemotePanel/GetSettings|22 0D 0A|",fast_pattern; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_RedLine, clamav:MALWARE.Win.Trojan.RedLine-1,MALWARE.Win.Trojan.RedLine-2"; classtype:trojan-activity; sid:920073; rev:2; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.Poullight outbound connection detected"; flow:to_server,established; http_client_body; content:"zipx="; http_header; content:"Expect: 100-continue"; content:"application/x-www-form-urlencoded"; http_uri; content:".php"; http_method; content:"POST"; http_header; content:!"User-Agent"; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_Poullight, clamav:MALWARE.Win.Trojan.Poullight"; classtype:trojan-activity; sid:920074; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.Poullight outbound connection detected"; flow:to_server,established; http_client_body; content:"avinstall="; content:"_version_="; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_Poullight, clamav:MALWARE.Win.Trojan.Poullight"; classtype:trojan-activity; sid:920075; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.Amady outbound connection detected"; flow:to_server,established; http_client_body; content:"id="; content:"vs="; content:"sd="; http_uri; content:"/index.php"; http_method; content:"POST"; http_header; content:!"User-Agent"; metadata:ruleset community, service http; classtype:trojan-activity; sid:920076; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.Amady credential plugin download detected"; flow:to_server,established; http_uri; content:"/cred.dll",fast_pattern; http_header; content:!"User-Agent"; content:!"Connection"; content:!"Content-Type"; content:!"Content-Length";  metadata::ruleset community, service http; rem:"yara:INDICATOR_TOOL_PWS_Amady"; classtype:trojan-activity; sid:920077; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.Amady screenshot plugin download detected"; flow:to_server,established; http_uri; content:"/scr.dll",fast_pattern; http_header; content:!"User-Agent"; content:!"Connection"; content:!"Content-Type"; content:!"Content-Length"; metadata:ruleset community, service http; rem:"yara:INDICATOR_TOOL_SCR_Amady"; classtype:trojan-activity; sid:920078; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.BlackNET RAT outbound connection detected"; flow:to_server,established; http_uri; content:"/connection.php?",fast_pattern; http_param:"data"; http_header; content:!"User-Agent"; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_BlackNET, clamav:MALWARE.Win.Trojan.BlackNET"; classtype:trojan-activity; sid:920079; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.BlackNET RAT outbound connection detected"; flow:to_server,established; http_uri; content:"/receive.php?",fast_pattern; http_param:"vicID"; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_BlackNET, clamav:MALWARE.Win.Trojan.BlackNET"; classtype:trojan-activity; sid:920080; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.BlackNET RAT outbound connection detected"; flow:to_server,established; http_uri; content:"/getCommand.php?",fast_pattern; http_param:"id"; http_header; content:!"User-Agent"; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_BlackNET, clamav:MALWARE.Win.Trojan.BlackNET"; classtype:trojan-activity; sid:920081; rev:1; )
alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:"MALWARE-CNC Win.Trojan.BlackNET RAT inbound Ping command detected"; flow:to_client,established; file_data; content:"UGluZw==",fast_pattern; isdataat:!1,relative; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_BlackNET, clamav:MALWARE.Win.Trojan.BlackNET"; classtype:trojan-activity; sid:920082; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.Wacapew infostealer outbound connection detected"; flow:to_server,established; http_uri; content:"/info/"; http_client_body; content:"info="; http_header:field user-agent; content:"Mozilla/5.0 (Windows NT 10.0|3B|"; http_header; content:"Accept-Language: ko-KR"; metadata:ruleset community, service http; classtype:trojan-activity; sid:920083; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.Hancitor outbound connection detected"; flow:to_server,established; http_client_body; content:"GUID="; content:"BUILD="; content:"INFO="; content:"TYPE="; content:"WIN="; metadata:ruleset community, service http; classtype:trojan-activity; sid:920084; rev:1; )
alert file ( msg:"MALWARE-OTHER Win.Trojan.Salfarm executable transfer detected"; file_type:"MSEXE"; file_data; content:"!This Salfram cannot be run in DOS mode.",fast_pattern; service:http, smtp; rem:"yara:MALWARE_Win_Salfram, clamav:MALWARE.Win.Trojan.Salfram"; classtype:policy-violation; sid:920085; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.PowerPool initial outbound connection detected"; flow:to_server,established; http_uri; content:"/?id="; content:"&info=",fast_pattern, distance 16; http_header; content:!"Accept-"; content:!"Referer"; content:!"Content"; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_PowerPool_STG1, clamav:MALWARE.Win.Trojan.PowerPool-STG-1"; classtype:trojan-activity; sid:920086; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.PowerPool heartbeat detected"; flow:to_server,established; http_uri; content:"/heart"; http_client_body; content:"|22|sessionid|22|",fast_pattern; http_header; content:"User-Agent: Mozilla/4.0 (compatible|3b| )"; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_PowerPool_STG2, clamav:MALWARE.Win.Trojan.PowerPool-STG-2"; classtype:trojan-activity; sid:920087; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.PowerPool execute command detected"; flow:to_server,established; http_uri; content:"/cmdpool",fast_pattern; http_client_body; content:"|22|dos|22|"; http_header; content:"User-Agent: Mozilla/4.0 (compatible|3b| )"; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_PowerPool_STG2, clamav:MALWARE.Win.Trojan.PowerPool-STG-2"; classtype:trojan-activity; sid:920088; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.PowerPool list directory detected"; flow:to_server,established; http_uri; content:"/cmdpool",fast_pattern; http_client_body; content:"|22|folder|22|"; http_header; content:"User-Agent: Mozilla/4.0 (compatible|3b| )"; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_PowerPool_STG2, clamav:MALWARE.Win.Trojan.PowerPool-STG-2"; classtype:trojan-activity; sid:920089; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.AHKStealer initial outbound connnection detected"; flow:to_server,established; http_header:field user-agent; content:"AutoHotkey"; http_uri; bufferlen:15; content:"-xl2",offset 11; metadata:ruleset community, service http; reference:url,www.trendmicro.com/en_us/research/20/l/stealth-credential-stealer-targets-us-canadian-bank-customers.html; classtype:trojan-activity; sid:920090; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.AHKStealer initial outbound connnection detected"; flow:to_server,established; http_header:field user-agent; content:"AutoHotkey"; http_uri; bufferlen:15; content:"-pro",offset 11; metadata:ruleset community, service http; reference:url,www.trendmicro.com/en_us/research/20/l/stealth-credential-stealer-targets-us-canadian-bank-customers.html; classtype:trojan-activity; sid:920091; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.AHKStealer status log outbound connnection detected"; flow:to_server,established; http_header:field user-agent; content:"AutoHotkey"; http_uri; bufferlen:11; http_client_body; content:"&log=passwords:"; metadata:ruleset community, service http; reference:url,www.trendmicro.com/en_us/research/20/l/stealth-credential-stealer-targets-us-canadian-bank-customers.html; classtype:trojan-activity; sid:920092; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.AHKStealer exfiltration outbound connnection detected"; flow:to_server,established; http_header:field user-agent; content:"AutoHotkey"; http_client_body; content:"hostname:"; content:"username:"; content:"password:"; metadata:ruleset community, service http; reference:url,www.trendmicro.com/en_us/research/20/l/stealth-credential-stealer-targets-us-canadian-bank-customers.html; classtype:trojan-activity; sid:920093; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.PyMICROPSIA outbound connection detected"; flow:to_server,established; http_uri; content:"/zoailloaze/"; http_header:field user-agent; content:"python-requests/"; metadata:ruleset community, service http; reference:url,unit42.paloaltonetworks.com/pymicropsia/; classtype:trojan-activity; sid:920094; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.DOC outbound connection detected"; flow:to_server,established; http_uri; content:"op="; content:"dt="; content:"uid="; http_header:field user-agent; content:"Mozilla/4.0 (compatible|3B| Win32|3B| WinHttp.WinHttpRequest.5)"; metadata:ruleset community, service http; reference:url,blog.alyac.co.kr/3458; classtype:trojan-activity; sid:920095; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Ransomware.Ziggy outbound connection detected"; flow:to_server,established; http_uri; content:"/ziggy/api/info.php",fast_pattern; content:"id="; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_Ziggy, clamav:MALWARE.Win.Ransomware.Ziggy"; classtype:trojan-activity; sid:920096; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.IceRAT stealer download check detected"; flow:to_server,established; http_uri; content:"/dow_stil.txt",fast_pattern; metadata:ruleset community, service http; classtype:trojan-activity; sid:920097; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.IceRAT coinminer download check detected"; flow:to_server,established; http_uri; content:"/dow_klip.txt",fast_pattern; metadata:ruleset community, service http; classtype:trojan-activity; sid:920098; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.TriumphLoader outbound connection detected"; flow:to_server,established; http_header:field user-agent; content:"TriumphLoader",fast_pattern; metadata:ruleset community, service http; rem:"yara:INDICATOR_EXE_Packed_TriumphLoader, clamav:INDICATOR.Packed.TriumphLoader"; classtype:trojan-activity; sid:920099; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.Alfonso stealer outbound connection detected"; flow:to_server,established; content:"|50 4B 03 04 14 00|"; content:"|00|Desktop.png",distance 0; metadata:ruleset community; rem:"yara:MALWARE_Win_Alfonso, clamav:MALWARE.Win.Trojan.Alfonso"; classtype:trojan-activity; sid:920100; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.CHUWI_Seth initial outbound connection detected"; flow:to_server,established; http_client_body; content:"HWID={",fast_pattern; content:"&name="; content:"&os="; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_CHUWI"; classtype:trojan-activity; sid:920101; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.CHUWI_Seth check command outbound connection detected"; flow:to_server,established; http_uri; content:"/check_command.php?",fast_pattern; content:"HWID={",nocase; content:"&act="; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_CHUWI_Seth"; classtype:trojan-activity; sid:920102; rev:2; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.CHUWI_Seth get command outbound connection detected"; flow:to_server,established; http_uri; content:"/get_command.php?",fast_pattern; content:"HWID={",nocase; content:"&command="; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_CHUWI_Seth"; classtype:trojan-activity; sid:920103; rev:2; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.TA505 PWSH DLL exfilatration outbound connection detected"; flow:to_server,established; http_uri; content:"/jquery.php"; http_header:field user-agent; content:"Embarcadero URI Client/"; http_method; content:"POST"; metadata:ruleset community, service http; reference:url,www.fsec.or.kr/common/proc/fsec/bbs/163/fileDownLoad/2297.do; classtype:trojan-activity; sid:920104; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.TA505 PWSH DLL exfilatration outbound connection detected"; flow:to_server,established; http_client_body; content:"key="; content:"sysid="; content:"resp="; metadata:ruleset community, service http; reference:url,www.fsec.or.kr/common/proc/fsec/bbs/163/fileDownLoad/2297.do; classtype:trojan-activity; sid:920105; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.Taurus outbound connection detected"; flow:to_server,established; http_uri; bufferlen:4; content:"/cfg/",fast_pattern; http_method; content:"POST"; metadata:ruleset community, service http; classtype:trojan-activity; sid:920106; rev:2; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.Taurus outbound connection detected"; flow:to_server,established; http_uri; bufferlen:4; content:"/dll/",fast_pattern; http_method; content:"POST"; metadata:ruleset community, service http; classtype:trojan-activity; sid:920107; rev:2; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.CryptBot outbound connection detected"; flow:to_server,established; content:"|50 4B 03 04 14 00|"; content:"|00|AllForms_list.txt",distance 0; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_CryptBot, clamav:MALWARE.Win.Trojan.CryptBot"; classtype:trojan-activity; sid:920108; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.QuilClipper outbound connection detected"; flow:to_server,established; http_header:field user-agent; content:"QUILCLIPPER",nocase,fast_pattern; metadata:ruleset community, service http; classtype:trojan-activity; sid:920109; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.Downloader agent outbound connection detected"; flow:to_server,established; http_uri; content:"/getrandombase64.php?get=",fast_pattern; http_header; content:!"User-Agent"; content:!"Connection"; metadata:ruleset community, service http; classtype:trojan-activity; sid:920110; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.STOP ransomware outbound connection detected"; flow:to_server,established; http_uri; content:"/get.php?pid=",fast_pattern; content:"&first="; http_header:field user-agent; content:"Microsoft Internet Explorer"; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_STOP, clamav:MALWARE.Win.Ransomware.STOP"; classtype:trojan-activity; sid:920111; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.Unknown rogue HTTP version outbound connection detected"; flow:to_server,established; http_version; content:"HTTPS/11.",fast_pattern; metadata:ruleset community, service http; reference:url,www.virustotal.com/gui/file/561064dddadbb6d96134d8cd9c46d51b70206ff7adcd034b8380f6010b0dc56e/detection/f-561064dddadbb6d96134d8cd9c46d51b70206ff7adcd034b8380f6010b0dc56e-1611655862; classtype:trojan-activity; sid:920112; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Linux.Trojan.XORDDoS configuration download attempt detected"; flow:to_server,established; http_header:field user-agent; content:"|3B 20|TencentTraveler|20 3B|"; http_header; content:"Accept-Language: zh-cn|0D 0A|"; metadata:ruleset community, service http; reference:url,www.lacework.com/groundhog-botnet-rapidly-infecting-cloud/; classtype:trojan-activity; sid:920113; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.Torsima outbound connection detected"; flow:to_server,established; http_client_body; content:"ACTION=VIEW&PAGE="; content:"&CODE="; content:"&CACHE="; content:"REQUEST="; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_Torisma"; reference:url,blogs.jpcert.or.jp/en/2021/01/Lazarus_malware2.html; classtype:trojan-activity; sid:920114; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.Torsima outbound connection detected"; flow:to_server,established; http_client_body; content:"ACTION=PREVPAGE&CODE=C"; content:"&RES="; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_Torisma"; reference:url,blogs.jpcert.or.jp/en/2021/01/Lazarus_malware2.html; classtype:trojan-activity; sid:920115; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.LCPDot outbound connection detected"; flow:to_server,established; http_client_body; content:"Cookie=Enable&CookieV="; content:"&Cookie_Time="; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_LCPDot"; reference:url,blogs.jpcert.or.jp/en/2021/01/Lazarus_malware2.html; classtype:trojan-activity; sid:920115; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.ArbitriumRAT outbound connection detected"; flow:to_server,established; http_uri; content:"/checkupdate.js?id=",fast_pattern; content:"&token="; content:"&platform="; metadata:ruleset community, service http; classtype:trojan-activity; sid:920116; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.Sn0w logger outbound connection detected"; flow:to_server,established; http_header:field user-agent; content:"RestSharp/"; http_uri; content:"/upload"; http_header; content:"Content-Type: multipart/form-data|3B|"; metadata:ruleset community, service http; classtype:trojan-activity; sid:920117; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.Sn0w logger outbound connection detected"; flow:to_server,established; http_client_body; content:"name=|22|token|22|"; content:"filename=|22|snow.txt|22|"; metadata:ruleset community, service http; classtype:trojan-activity; sid:920118; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.DotNetDownloader outbound connection detected"; flow:to_server,established; http_uri; content:"/base/"; bufferlen:43; pcre:"/[A-F0-9]{32}\.html/"; http_header; content:!"User-Agent"; content:!"Content"; content:!"Accept"; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_DLAgent06"; classtype:trojan-activity; sid:920119; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.Razy infostealer outbound connection detected"; flow:to_server,established; http_client_body; content:"type="; content:"seller="; content:"guid="; content:"origin="; metadata:ruleset community, service http; classtype:trojan-activity; sid:920120; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.FujinamaRAT outbound connection detected"; flow:to_server,established; http_uri; content:"/copy.php?file= [",fast_pattern; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_FujinamaRAT"; classtype:trojan-activity; sid:920121; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Trojan.AsyncRAT inbound SSL certificate"; flow:to_client,established; content:"|55 04 03 0C|"; content:"DcRat Server",fast_pattern,distance 1,nocase; metadata:ruleset community, service ssl; classtype:trojan-activity; sid:920122; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.Redosdru downloader outbound connection detected"; flow:to_server,established; http_header:field user-agent; content:"Mozilla/4.0 (compatible)",fast_pattern; http_header; content:"Cache-Control: no-cache|0D 0A|"; content:!"Connection"; content:!"Content-Type"; content:!"Accept"; metadata:ruleset community, service http; classtype:trojan-activity; sid:920123; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.RedLine SendClientInfo outbound connection detected"; flow:to_server,established; http_header; content:"/IRemotePanel/SendClientInfo|22 0D 0A|",fast_pattern; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_RedLine, clamav:MALWARE.Win.Trojan.RedLine-1,MALWARE.Win.Trojan.RedLine-2"; classtype:trojan-activity; sid:920124; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.RedLine GetTasks outbound connection detected"; flow:to_server,established; http_header; content:"/IRemotePanel/GetTasks|22 0D 0A|",fast_pattern; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_RedLine, clamav:MALWARE.Win.Trojan.RedLine-1,MALWARE.Win.Trojan.RedLine-2"; classtype:trojan-activity; sid:920125; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.DLAgent outbound connection detected"; flow:to_server,established; http_header; content:"Content-Type: text/html MySpecialHeder:",fast_pattern; metadata:ruleset community, service http; classtype:trojan-activity; sid:920126; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.PUA adware outbound connection detected"; flow:to_server,established; http_uri; content:"/api/userapi.ashx?action=",fast_pattern; http_header; content:"User-Agent: Mozilla/4.0"; metadata:ruleset community, service http; classtype:trojan-activity; sid:920127; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.JSAgent outbound connection detected"; flow:to_server,established; http_uri; content:"/show?type=name",fast_pattern; http_method; content:"POST"; metadata:ruleset community, service http; reference:url,www.virustotal.com/gui/file/932ae9385156631661b272cfbda1351c2411ac1dd7f4e80267ce32ccc12e4347/detection; classtype:trojan-activity; sid:920128; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.JSAgent outbound connection detected"; flow:to_server,established; http_uri; content:"/new?type=name",fast_pattern; http_method; content:"POST"; metadata:ruleset community, service http; reference:url,www.virustotal.com/gui/file/932ae9385156631661b272cfbda1351c2411ac1dd7f4e80267ce32ccc12e4347/detection; classtype:trojan-activity; sid:920129; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.JSAgent outbound connection detected"; flow:to_server,established; http_uri; content:"/add?type=name",fast_pattern; http_method; content:"POST"; metadata:ruleset community, service http; reference:url,www.virustotal.com/gui/file/932ae9385156631661b272cfbda1351c2411ac1dd7f4e80267ce32ccc12e4347/detection; classtype:trojan-activity; sid:920130; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.JSAgent outbound connection detected"; flow:to_server,established; http_uri; content:"/delete?type=name",fast_pattern; http_method; content:"POST"; metadata:ruleset community, service http; reference:url,www.virustotal.com/gui/file/932ae9385156631661b272cfbda1351c2411ac1dd7f4e80267ce32ccc12e4347/detection; classtype:trojan-activity; sid:920131; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.JSAgent outbound connection detected"; flow:to_server,established; http_uri; content:"/renew?type=name",fast_pattern; http_method; content:"POST"; metadata:ruleset community, service http; reference:url,www.virustotal.com/gui/file/932ae9385156631661b272cfbda1351c2411ac1dd7f4e80267ce32ccc12e4347/detection; classtype:trojan-activity; sid:920132; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.JSAgent outbound connection detected"; flow:to_server,established; http_uri; content:"?type=name"; http_header:field user-agent; content:"Mozilla/4.0 (compatible|3B| Win32|3B| WinHttp.WinHttpRequest.5)"; http_method; content:"POST"; metadata:ruleset community, service http; reference:url,www.virustotal.com/gui/file/932ae9385156631661b272cfbda1351c2411ac1dd7f4e80267ce32ccc12e4347/detection; classtype:trojan-activity; sid:920133; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.VJWorm variant outbound connection"; flow:to_server,established; content:"User-Agent: vjw0rm",nocase,fast_pattern; metadata:ruleset community, service http; classtype:trojan-activity; sid:920134; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.FakeSupport outbound connection detected"; flow:to_server,established; http_uri; content:"/api_update.php?id=",fast_pattern; content:"TeamViewer_id="; metadata:ruleset community, service http; classtype:trojan-activity; sid:920135; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.RedLine AutoHotKey downloader outbound connection detected"; flow:to_server,established; http_uri; content:"/bestof/gfers.exe",fast_pattern; metadata:ruleset community, service http; classtype:trojan-activity; sid:920136; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.Unknown outbound connection detected"; flow:to_server,established; http_header:field user-agent; content:"A WinHTTP Example Program/"; http_client_body; content:"info="; metadata:ruleset community, service http; classtype:trojan-activity; sid:920137; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Osx.Trojan.Pirrit outbound connection detected"; flow:to_server,established; http_uri; content:"id="; content:"pv="; content:"mvr="; content:"mvsi="; content:"ch="; metadata:ruleset community, service http; classtype:trojan-activity; sid:920138; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Osx.Trojan.Pirrit outbound connection detected"; flow:to_server,established; http_uri; content:"/c/ci?"; content:"tm="; content:"&id="; metadata:ruleset community, service http; classtype:trojan-activity; sid:920139; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg: "MALWARE-CNC Win.Trojan.STRRAT outbound connection detected"; flow:to_server,established; content:"|7C|STRRAT|7C|",fast_pattern; metadata:ruleset community; classtype:trojan-activity; sid:920140; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.DCRat outbound connection detected"; flow:to_server; http_header; content:"Content-Type: text/csv"; content:"Accept: */*|0D 0A|"; content:!"Connection"; http_uri; content:".php?"; bufferlen:>150; metadata:ruleset community, service http; classtype:trojan-activity; sid:920141; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"INDICATOR-COMPROMISE Browser cookies exfiltration detected"; flow:to_server; http_client_body; content:"Browsers/PK",nocase; content:"Browsers/Cookies [",nocase,distance 0; http_method; content:"POST"; metadata:ruleset community, service http; classtype:trojan-activity; sid:920142; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"INDICATOR-COMPROMISE Browser passwords exfiltration detected"; flow:to_server; http_client_body; content:"Browsers/PK",nocase; content:"Browsers/Passwords [",nocase,distance 0; http_method; content:"POST"; metadata:ruleset community, service http; classtype:trojan-activity; sid:920143; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"INDICATOR-COMPROMISE Screenshot exfiltration detected"; flow:to_server; http_client_body; content:"Screenshots/PK",nocase; content:"Screenshots/",nocase,distance 0; http_method; content:"POST"; metadata:ruleset community, service http; classtype:trojan-activity; sid:920144; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.RedLine GetArguments outbound connection detected"; flow:to_server,established; http_header; content:"SOAPAction:"; content:"/Endpoint/GetArguments|22 0D 0A|",fast_pattern; http_uri; bufferlen:1; http_method; content:"POST"; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_RedLine, clamav:MALWARE.Win.Trojan.RedLine-1,MALWARE.Win.Trojan.RedLine-2"; classtype:trojan-activity; sid:920145; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.RedLine VerifyScanRequest outbound connection detected"; flow:to_server,established; http_header; content:"SOAPAction:"; content:"/Endpoint/VerifyScanRequest|22 0D 0A|",fast_pattern; http_uri; bufferlen:1; http_method; content:"POST"; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_RedLine, clamav:MALWARE.Win.Trojan.RedLine-1,MALWARE.Win.Trojan.RedLine-2"; classtype:trojan-activity; sid:920146; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.RedLine GetUpdates outbound connection detected"; flow:to_server,established; http_header; content:"SOAPAction:"; content:"/Endpoint/GetUpdates|22 0D 0A|",fast_pattern; http_uri; bufferlen:1; http_method; content:"POST"; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_RedLine, clamav:MALWARE.Win.Trojan.RedLine-1,MALWARE.Win.Trojan.RedLine-2"; classtype:trojan-activity; sid:920147; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.RedLine VerifyUpdate outbound connection detected"; flow:to_server,established; http_header; content:"SOAPAction:"; content:"/Endpoint/VerifyUpdate|22 0D 0A|",fast_pattern; http_uri; bufferlen:1; http_method; content:"POST"; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_RedLine, clamav:MALWARE.Win.Trojan.RedLine-1,MALWARE.Win.Trojan.RedLine-2"; classtype:trojan-activity; sid:920148; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.CoinMiningBot update request connection detected"; flow:to_server,established; http_uri; bufferlen:19; content:"/Data/GetUpdateInfo",fast_pattern; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_CoinMiningBot"; classtype:trojan-activity; sid:920149; rev:1; )
alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:"MALWARE-CNC Win.Trojan.CoinMiningBot update response connection detected"; flow:to_client,established; file_data; content:"|3C|UpdateBot"; content:"|3C|Version",distance 0,fast_pattern; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_CoinMiningBot"; classtype:trojan-activity; sid:920150; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.CRAT outbound connection detected"; flow:to_server,established; http_header; content:"User-Agent: Mozilla/5.0|0D 0A|"; http_uri; content:"/index.php?timestamp="; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_CRAT"; classtype:trojan-activity; sid:920151; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.CRAT outbound connection detected"; flow:to_server,established; http_uri; content:"/index.php?timestamp=",fast_pattern; http_client_body; content:"id=0"; content:"&content="; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_CRAT"; classtype:trojan-activity; sid:920152; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET [25,26,587] ( msg:"MALWARE-CNC Win.Ransomware.JobCryptor outbound SMTP connection"; flow:to_server,established; content:"RTEE="; content:"RRTC:",fast_pattern,within 20; metadata:ruleset community, service smtp; reference:url,yoroi.company/research/ransomware-micro-criminals-are-still-out-here-and-growing/; classtype:trojan-activity; sid:920153; rev:2; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg: "MALWARE-CNC Win.Trojan.CobianRAT outbound connection detected"; flow:to_server,established; content:"LOGIN|7C|-|7C|",fast_pattern; metadata:ruleset community; reference:url,www.zscaler.com/blogs/security-research/cobian-rat-backdoored-rat; classtype:trojan-activity; sid:920154; rev:1; )
alert icmp $HOME_NET any -> $EXTERNAL_NET any ( msg: "MALWARE-CNC Win.Trojan.PingBack shell command outbound connection detected"; dsize:788; icode:0; itype:8; content:"shell|00|",fast_pattern; metadata:ruleset community; reference:url,www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/backdoor-at-the-end-of-the-icmp-tunnel/; classtype:trojan-activity; sid:920155; rev:1; )
alert icmp $HOME_NET any -> $EXTERNAL_NET any ( msg: "MALWARE-CNC Win.Trojan.PingBack download command outbound connection detected"; dsize:788; icode:0; itype:8; content:"download|00|",fast_pattern; metadata:ruleset community; reference:url,www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/backdoor-at-the-end-of-the-icmp-tunnel/; classtype:trojan-activity; sid:920156; rev:1; )
alert icmp $HOME_NET any -> $EXTERNAL_NET any ( msg: "MALWARE-CNC Win.Trojan.PingBack upload command outbound connection detected"; dsize:788; icode:0; itype:8; content:"upload|00|",fast_pattern; metadata:ruleset community; reference:url,www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/backdoor-at-the-end-of-the-icmp-tunnel/; classtype:trojan-activity; sid:920157; rev:1; )
alert icmp $HOME_NET any -> $EXTERNAL_NET any ( msg: "MALWARE-CNC Win.Trojan.PingBack exec command outbound connection detected"; dsize:788; icode:0; itype:8; content:"exec|00|",fast_pattern; metadata:ruleset community; reference:url,www.trustwave.com/en-us/resources/blogs/spiderlabs-blog/backdoor-at-the-end-of-the-icmp-tunnel/; classtype:trojan-activity; sid:920158; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.Banload outbound connection detected"; flow:to_server,established; http_uri; content:"/checkin?host=",fast_pattern; content:"&user"; http_header; content:"User-Agent: Go-"; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_Banload"; classtype:trojan-activity; sid:920159; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.Banload outbound connection detected"; flow:to_server,established; http_uri; content:"/command?id=",fast_pattern; http_header; content:"User-Agent: Go-"; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_Banload"; classtype:trojan-activity; sid:920160; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.BazarLoader outbound connection detected"; flow:to_server,established; http_header:field user-agent; content:"apiutwq",fast_pattern; metadata:ruleset community, service http; classtype:trojan-activity; sid:920161; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.DLAgent07 outbound connection detected"; flow:to_server,established; http_header:field user-agent; content:"zipo",fast_pattern; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_DLAgent07"; classtype:trojan-activity; sid:920162; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.TYRAT outbound connection detected"; flow:to_server,established; http_uri; content:"/TY.jpg"; http_header; content:"Accept-Language: zh-cn|0D 0A|"; content:!"Connection"; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_TYRAT"; classtype:trojan-activity; sid:920163; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.TYRAT outbound connection detected"; flow:to_server,established; content:".db HTTP/1.1"; http_header; content:"Accept-Language: zh-cn"; content:!"Connection"; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_TYRAT"; classtype:trojan-activity; sid:920164; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.Downloader outbound connection detected"; flow:to_server,established; http_header:field user-agent; content:"InnoDownloadPlugin/",fast_pattern; http_uri; content:".exe"; metadata:ruleset community, service http; classtype:trojan-activity; sid:920165; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.DLInjector03 outbound connection detected"; flow:to_server,established; http_uri; content:"/addInstall.php?key=",fast_pattern; content:"&ip="; content:"&oid="; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_MALWARE_Win_DLInjector03"; classtype:trojan-activity; sid:920166; rev:2; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Ransomware.DecryptMyFiles outbound connection detected"; flow:to_server,established; http_header:field user-agent; content:"uniquesession",fast_pattern; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_DecryptMyFiles"; classtype:trojan-activity; sid:920167; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Ransomware.DecryptMyFiles outbound connection detected"; flow:to_server,established; http_uri; content:"api/connect.php"; http_header; content:"Content-Type: application/text"; http_method; content:"POST"; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_DecryptMyFiles"; classtype:trojan-activity; sid:920167; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.Phorpiex variant outbound connection detected"; flow:to_server,established; http_uri; content:"/tst.php"; http_header:field user-agent; content:"iPhone|3B|"; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_Phorpiex"; classtype:trojan-activity; sid:920168; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Trojan.PandaStealer outbound connection detected"; flow:to_server,established; http_uri; content:"/collect.php"; http_header:field user-agent; content:"uploader"; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_PandaStealer"; classtype:trojan-activity; sid:920169; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Trojan.OrcusRAT inbound SSL certificate"; flow:to_client,established; content:"|55 04 03|"; content:"OrcusServerCertificate|30|",fast_pattern,distance 2; metadata:ruleset community, service ssl; classtype:trojan-activity; sid:920170; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"INDICATOR-COMPROMISE Browser cookies exfiltration detected"; flow:to_server; http_client_body; content:"Browsers/Cookies/PK",nocase; http_method; content:"POST"; metadata:ruleset community, service http; classtype:trojan-activity; sid:920171; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"INDICATOR-COMPROMISE Browser logins exfiltration detected"; flow:to_server; http_client_body; content:"Browsers/Logins/PK",nocase; http_method; content:"POST"; metadata:ruleset community, service http; classtype:trojan-activity; sid:920172; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"INDICATOR-COMPROMISE Browser grabber exfiltration detected"; flow:to_server; http_client_body; content:"Grabber/Desktop/",nocase; http_method; content:"POST"; metadata:ruleset community, service http; classtype:trojan-activity; sid:920173; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"INDICATOR-COMPROMISE Browser cards exfiltration detected"; flow:to_server; http_client_body; content:"Browsers/Cards/PK",nocase; http_method; content:"POST"; metadata:ruleset community, service http; classtype:trojan-activity; sid:920174; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.AllaKore outbound connection detected"; flow:to_server,established; dsize:14; content:"|3C 7C|MAINSOCKET|7C 3E|",fast_pattern; metadata:ruleset community; rem:"yara:MALWATE_Win_AllaKore"; classtype:trojan-activity; sid:920175; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.AllaKore outbound connection detected"; flow:to_server,established; content:"|3C 7C|DESKTOPSOCKET|7C 3E|",fast_pattern; metadata:ruleset community; rem:"yara:MALWATE_Win_AllaKore"; classtype:trojan-activity; sid:920176; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.AllaKore outbound connection detected"; flow:to_server,established; content:"|3C 7C|FILESSOCKET|7C 3E|",fast_pattern; metadata:ruleset community; rem:"yara:MALWATE_Win_AllaKore"; classtype:trojan-activity; sid:920177; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.AllaKore outbound connection detected"; flow:to_server,established; content:"|3C 7C|KEYBOARDSOCKET|7C 3E|",fast_pattern; metadata:ruleset community; rem:"yara:MALWATE_Win_AllaKore"; classtype:trojan-activity; sid:920178; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Trojan.AllaKore outbound connection detected"; flow:to_client,established; dsize:<25; content:"|3C 7C|SETPING|7C 3E|",fast_pattern; metadata:ruleset community; rem:"yara:MALWATE_Win_AllaKore"; classtype:trojan-activity; sid:920179; rev:1; )
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"MALWARE-CNC Win.Trojan.XpertRAT variant outbound connection detected"; flow:to_server,established; content:"X - Xpert|7C|",fast_pattern; metadata:ruleset community; rem:"yara:MALWARE_Win_XpertRAT"; classtype:trojan-activity; sid:920180; rev:1; )
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"MALWARE-CNC Win.Trojan.XpertRAT variant inbound connection detected"; flow:to_client,established; content:"|5C|XpertRAT|7C|",fast_pattern; metadata:ruleset community; rem:"yara:MALWARE_Win_XpertRAT"; classtype:trojan-activity; sid:920181; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Ransomware.Spyro-VoidCrypt outbound connection detected"; flow:to_server; http_header:field user-agent; content:"Voidcrypt/",fast_pattern,nocase; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_Spyro"; classtype:trojan-activity; sid:920182; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Ransomware.Spyro-VoidCrypt outbound connection detected"; flow:to_server; http_client_body; content:"unique-id="; content:"disk-size="; content:"user="; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_Spyro"; classtype:trojan-activity; sid:920183; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"MALWARE-CNC Win.Ransomware.Spyro-VoidCrypt outbound connection detected"; flow:to_server; http_uri; content:"/voidcrypt/index.php",fast_pattern; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_Spyro"; classtype:trojan-activity; sid:920184; rev:1; )
################################################
# INDICATOR PACKED
################################################
alert file ( msg:"INDICATOR-PACKED Spices.Net packed executable file transfer detected"; file_type:"MSEXE"; file_data; content:"protected by 9Rays.Net Spices.Net Obfuscator",fast_pattern; service:http, smtp; rem:"yara:INDICATOR_EXE_Packed_Spices"; classtype:policy-violation; sid:930000; rev:1; )
alert file ( msg:"INDICATOR-PACKED PS2EXE packed executable file transfer detected"; file_type:"MSEXE"; file_data; content:"PS2EXE",fast_pattern; service:http, smtp; rem:"yara:INDICATOR_EXE_Packed_PS2EXE"; classtype:policy-violation; sid:930001; rev:1; )
alert file ( msg:"INDICATOR-PACKED ASPACK packed executable file transfer detected"; file_type:"MSEXE"; file_data; content:"|2E 61 73 70 61 63 6B 00 00|",nocase,fast_pattern; service:http, smtp; rem:"yara:INDICATOR_EXE_Packed_ASPack"; classtype:policy-violation; sid:930002; rev:1; )
alert file ( msg:"INDICATOR-PACKED Titan packed executable file transfer detected"; file_type:"MSEXE"; file_data; content:"|2E 74 69 74 61 6E 00 00|",nocase,fast_pattern; service:http, smtp; rem:"yara:INDICATOR_EXE_Packed_Titan"; classtype:policy-violation; sid:930003; rev:1; )
alert file ( msg:"INDICATOR-PACKED AspireCrypt packed executable file transfer detected"; file_type:"MSEXE"; file_data; content:"protected by AspireCrypt",fast_pattern; service:http, smtp; rem:"yara:INDICATOR_EXE_Packed_AspireCrypt"; classtype:policy-violation; sid:930004; rev:1; )
alert file ( msg:"INDICATOR-PACKED ConfuserEx packed executable file transfer detected"; file_type:"MSEXE"; file_data; content:"ConfuserEx",fast_pattern; service:http, smtp; rem:"yara:INDICATOR_EXE_Packed_ConfuserEx"; classtype:policy-violation; sid:930005; rev:1; )
alert file ( msg:"INDICATOR-PACKED ConfuserEx packed executable file transfer detected"; file_type:"MSEXE"; file_data; content:"ConfusedByAttribute",fast_pattern; service:http, smtp; rem:"yara:INDICATOR_EXE_Packed_ConfuserEx"; classtype:policy-violation; sid:930006; rev:1; )
alert file ( msg:"INDICATOR-PACKED ConfuserExMod BedsProtector packed executable file transfer detected"; file_type:"MSEXE"; file_data; content:"Beds Protector",nocase,fast_pattern; service:http, smtp; rem:"yara:INDICATOR_EXE_Packed_ConfuserExMod_BedsProtector"; classtype:policy-violation; sid:930007; rev:1; )
alert file ( msg:"INDICATOR-PACKED ConfuserExMod BedsProtector packed executable file transfer detected"; file_type:"MSEXE"; file_data; content:"Beds-Protector",nocase,fast_pattern; service:http, smtp; rem:"yara:INDICATOR_EXE_Packed_ConfuserExMod_BedsProtector"; classtype:policy-violation; sid:930008; rev:1; )
alert file ( msg:"INDICATOR-PACKED ConfuserExMod Trinity packed executable file transfer detected"; file_type:"MSEXE"; file_data; content:"TrinityProtector",nocase,fast_pattern; service:http, smtp; rem:"yara:INDICATOR_EXE_Packed_ConfuserExMod_Trinity"; classtype:policy-violation; sid:930009; rev:1; )
alert file ( msg:"INDICATOR-PACKED ConfuserExMod Trinity packed executable file transfer detected"; file_type:"MSEXE"; file_data; content:"Trinity0-protecor",nocase,fast_pattern; service:http, smtp; rem:"yara:INDICATOR_EXE_Packed_ConfuserExMod_Trinity"; classtype:policy-violation; sid:930010; rev:1; )
alert file ( msg:"INDICATOR-PACKED MPRESS packed executable file transfer detected"; file_type:"MSEXE"; file_data; content:".MPRESS",fast_pattern; service:http, smtp; rem:"yara:INDICATOR_EXE_Packed_MPress"; classtype:policy-violation; sid:930011; rev:1; )
alert file ( msg:"INDICATOR-PACKED Nate packed executable file transfer detected"; file_type:"MSEXE"; file_data; content:".nate",fast_pattern; service:http, smtp; rem:"yara:INDICATOR_EXE_Packed_Nate"; classtype:policy-violation; sid:930012; rev:1; )
alert file ( msg:"INDICATOR-PACKED BoxedApp packed executable file transfer detected"; file_type:"MSEXE"; file_data; content:".bxpck",fast_pattern; service:http, smtp; rem:"yara:INDICATOR_EXE_Packed_BoxedApp"; classtype:policy-violation; sid:930013; rev:1; )
alert file ( msg:"INDICATOR-PACKED BoxedApp packed executable file transfer detected"; file_type:"MSEXE"; file_data; content:"BoxedAppSDK_HookFunction",fast_pattern; service:http, smtp; rem:"yara:INDICATOR_EXE_Packed_BoxedApp"; classtype:policy-violation; sid:930014; rev:1; )
alert file ( msg:"INDICATOR-PACKED eXPressor packed executable file transfer detected"; file_type:"MSEXE"; file_data; content:".ex_cod",fast_pattern; service:http, smtp; rem:"yara:INDICATOR_EXE_Packed_eXPressor"; classtype:policy-violation; sid:930015; rev:1; )
alert file ( msg:"INDICATOR-PACKED eXPressor packed executable file transfer detected"; file_type:"MSEXE"; file_data; content:"eXPressor_InstanceChecker_",fast_pattern; service:http, smtp; rem:"yara:INDICATOR_EXE_Packed_eXPressor"; classtype:policy-violation; sid:930016; rev:1; )
alert file ( msg:"INDICATOR-PACKED VMProtect packed executable file transfer detected"; file_type:"MSEXE"; file_data; content:".vmp",fast_pattern; service:http, smtp; rem:"yara:INDICATOR_EXE_Packed_VMProtect"; classtype:policy-violation; sid:930017; rev:1; )
alert file ( msg:"INDICATOR-PACKED Engima packed executable file transfer detected"; file_type:"MSEXE"; file_data; content:".enigma",fast_pattern; service:http, smtp; rem:"yara:INDICATOR_EXE_Packed_Enigma"; classtype:policy-violation; sid:930018; rev:1; )
alert file ( msg:"INDICATOR-PACKED LibZ packed executable file transfer detected"; file_type:"MSEXE"; file_data; content:"LibZ.Injected",fast_pattern; service:http, smtp; rem:"yara:INDICATOR_EXE_Packed_LibZ"; classtype:policy-violation; sid:930019; rev:1; )
alert file ( msg:"INDICATOR-PACKED LibZ packed executable file transfer detected"; file_type:"MSEXE"; file_data; content:"asmz://",fast_pattern; service:http, smtp; rem:"yara:INDICATOR_EXE_Packed_LibZ"; classtype:policy-violation; sid:930020; rev:1; )
alert file ( msg:"INDICATOR-PACKED LSD packed executable file transfer detected"; file_type:"MSEXE"; file_data; content:"the LSD executable packer",fast_pattern; service:http, smtp; rem:"yara:INDICATOR_EXE_Packed_LSD"; classtype:policy-violation; sid:930021; rev:1; )
alert file ( msg:"INDICATOR-PACKED EXE2MSI-free packed executable file transfer detected"; file_type:"MSOLE2"; file_data; content:"Exe to msi converter free",fast_pattern; service:http, smtp; rem:"yara:INDICATOR_MSI_EXE2MSI"; classtype:policy-violation; sid:930022; rev:1; )
alert file ( msg:"INDICATOR-PACKED RLPack packed executable file transfer detected"; file_type:"MSEXE"; file_data; content:"|2E 52 4C 50 61 63 6B 00|",fast_pattern; service:http, smtp; rem:"yara:INDICATOR_EXE_Packed_RLPack"; classtype:policy-violation; sid:930023; rev:1; )
alert file ( msg:"INDICATOR-PACKED Themida packed executable file transfer detected"; file_type:"MSEXE"; file_data; content:"|2E 74 68 65 6D 69 64 61 00|",fast_pattern; service:http, smtp; rem:"yara:INDICATOR_EXE_Packed_Themida"; classtype:policy-violation; sid:930024; rev:1; )
alert file ( msg:"INDICATOR-PACKED Silent Install Builder demo packed executable file transfer detected"; file_type:"MSEXE"; file_data; content:"|2d 00 3e 00 6d 00 62 00 21 00 53 00 69 00 6c 00 65 00 6e 00 74 00 20 00 49 00 6e 00 73 00 74 00 61 00 6c 00 6c 00 20 00 42 00 75 00 69 00 6c 00 64 00 65 00 72 00 20 00 44 00 65 00 6d 00 6f|",fast_pattern; service:http, smtp; rem:"yara:INDICATOR_EXE_Packed_SilentInstallBuilder"; classtype:policy-violation; sid:930025; rev:1; )
alert file ( msg:"INDICATOR-PACKED NyanX-CAT CSharpLoader packed executable file transfer detected"; file_type:"MSEXE"; file_data; content:"|00 50 72 6f 67 72 61 6d 00 4c 6f 61 64 65 72 00 4e 79 61 6e 00|",fast_pattern; service:http, smtp; rem:"yara:INDICATOR_Packed_NyanXCat_CSharpLoader, clamav:INDICATOR.Packed.NyanXCAT-CSharpLoader"; classtype:policy-violation; sid:930026; rev:1; )
alert file ( msg:"INDICATOR-PACKED AVIator executable AV bypass download attempt"; flow:to_server,established; file_type:"MSEXE"; file_data; content:"A|00|V|00|/|00 5C 00|t|00|o|00|r",fast_pattern; metadata:ruleset community, service smtp; rem:"yara:INDICATOR_TOOL_AVBypass_AVIator"; classtype:trojan-activity; sid:930027; rev:1;)
alert file ( msg:"INDICATOR-PACKED AVIator malicious executable AV bypass download attempt"; flow:to_client,established; file_type:"MSEXE"; file_data; content:"|00|APCInjection",fast_pattern; content:"|00|threadHijackin_"; metadata:ruleset community, service ftp-data, service http, service imap, service pop3; rem:"yara:INDICATOR_TOOL_AVBypass_AVIator"; classtype:trojan-activity; sid:930028; rev:1;)
alert file ( msg:"INDICATOR-PACKED Fody manipulated executable file transfer detected"; file_type:"MSEXE"; file_data; content:"ProcessedByFody",fast_pattern; metadata:ruleset community, service ftp-data, service http, service imap, service pop3; rem:"yara:INDICATOR_EXE_Packed_Fody"; classtype:trojan-activity; sid:930029; rev:1;)
################################################
# INDICATOR SUSPICIOUS
################################################
alert http $EXTERNAL_NET any -> $HOME_NET $HTTP_PORTS ( msg:"INDICATOR-OBFUSCATION Spoofed Host header"; flow:to_server,established; http_header:field host; content:"127.0.0.1",fast_pattern; metadata:ruleset community, service http; classtype:misc-activity; sid:940060; rev:1; )
alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:"INDICATOR-OBFUSCATION Encoded executable download detected - AlienCrypter"; flow:to_client,established; file_data; content:"</p><p>@@@77,90,",fast_pattern; metadata:ruleset community, service http; classtype:trojan-activity; sid:940061; rev:1; )
alert http $EXTERNAL_NET $HTTP_PORTS -> $HOME_NET any ( msg:"INDICATOR-OBFUSCATION Encoded executable download detected - AlienCrypter"; flow:to_client,established; file_data; content:"</p><p>@@@HH,JA,",fast_pattern; metadata:ruleset community, service http; classtype:trojan-activity; sid:940062; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"INDICATOR-SUSPICIOUS empty User-Agent detected"; flow:to_server,established; http_header; content:"User-Agent|3A 20 0D 0A|",fast_pattern; metadata:ruleset community, service http; classtype:policy-violation; sid:940063; rev:1; )
alert file ( msg:"INDICATOR-SUSPICIOUS FOMB binary managed object format file magic detected"; file_data; content:"|46 4F 4D 42|",depth 4; flowbits:set,file.fomb; service:http, smtp; reference:url,www.fireeye.com/blog/threat-research/2019/10/certutil-qualms-they-came-to-drop-fombs.html; classtype:policy-violation; sid:940064; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"INDICATOR-SUSPICIOUS User-Agent detected - Moz5"; flow:to_server,established; http_header:field user-agent; content:"Moz5",fast_pattern; metadata:ruleset community, service http; classtype:policy-violation; sid:940065; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"INDICATOR-SUSPICIOUS User-Agent detected - QQ____"; flow:to_server,established; http_header:field user-agent; content:"QQ____",fast_pattern; metadata:ruleset community, service http; classtype:policy-violation; sid:940066; rev:1; )
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"INDICATOR-SUSPICIOUS User-Agent detected - wget"; flow:to_server,established; http_header; content:"User-Agent: wget|0D 0A|",fast_pattern; content:"Accept-Language: zh-cn"; metadata:ruleset community, service http; rem:"yara:MALWARE_Win_TYRAT"; classtype:policy-violation; sid:940067; rev:1; )
################################################
# INDICATOR POLICY
################################################
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"POLICY-OTHER Remote Administration Tool detected - RemoteUtilities"; flow:to_server,established; content:"<rman_message version=",fast_pattern; content:"<code>1</code>"; metadata:ruleset community; classtype:policy-violation; sid:950000; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"POLICY-OTHER Remote Administration Tool detected - RemoteUtilities"; flow:to_client,established; content:"<rman_message version=",fast_pattern; content:"<code>3</code>"; content:"</rman_message>",distance 0; metadata:ruleset community; classtype:policy-violation; sid:950001; rev:1;)
alert tcp $HOME_NET any -> $EXTERNAL_NET any ( msg:"POLICY-OTHER Remote Administration Tool detected - Imminent"; flow:to_server,established; dsize:10; content:"|06 00 00 00 81 13 14 6E 5B 69|",fast_pattern; metadata:ruleset community; classtype:policy-violation; sid:950002; rev:1;)
alert tcp $EXTERNAL_NET any -> $HOME_NET any ( msg:"POLICY-OTHER Remote Administration Tool detected - Imminent"; flow:to_client,established; dsize:48; content:"|2C 00 00 00 02 00 00 00 01|",fast_pattern; content:"$",distance 2; metadata:ruleset community; classtype:policy-violation; sid:950003; rev:1;)
alert http $HOME_NET any -> $EXTERNAL_NET $HTTP_PORTS ( msg:"POLICY-OTHER Iluminati proxy/anonymizer download/upgrade detected"; flow:to_server,established; http_uri; content:"/admin/rmt/luminati.io/",fast_pattern; metadata:ruleset community, service http; classtype:trojan-activity; sid:950004; rev:1;)